# Инструкция по тестированию функции создания игры

## Подготовка к тестированию

1. Убедитесь, что веб-сервер запущен и база данных доступна
2. Откройте браузер и перейдите на `index.php?method=creategame`
3. Проверьте, что форма загружается без ошибок

## Тестовые сценарии

### 1. Позитивные тесты (должны проходить успешно)

#### Тест 1.1: Создание базовой игры
- Название: "Тестовая игра"
- Ширина карты: 100
- Высота карты: 100
- Порядок ходов: "По очереди"
- Игроки: "Игрок1", "Игрок2"
- **Ожидаемый результат**: Игра создается, редирект на selectgame

#### Тест 1.2: Максимальное количество игроков
- Добавьте 16 игроков с уникальными именами
- **Ожидаемый результат**: Игра создается успешно

#### Тест 1.3: Минимальные размеры карты
- Ширина: 50, Высота: 50
- **Ожидаемый результат**: Игра создается успешно

#### Тест 1.4: Максимальные размеры карты  
- Ширина: 500, Высота: 500
- **Ожидаемый результат**: Игра создается успешно

#### Тест 1.5: Разные типы ходов
- Протестируйте каждый тип: "Одновременно", "По очереди", "По очереди за одним компьютером"
- **Ожидаемый результат**: Все типы работают корректно

### 2. Негативные тесты (должны показывать ошибки)

#### Тест 2.1: Пустое название игры
- Оставьте поле "Название" пустым
- **Ожидаемый результат**: Ошибка "Название игры не может быть пустым"

#### Тест 2.2: Недостаточно игроков
- Добавьте только одного игрока или оставьте все поля игроков пустыми
- **Ожидаемый результат**: Ошибка "Для игры необходимо минимум 2 игрока"

#### Тест 2.3: Дублирующиеся имена игроков
- Введите одинаковые имена для разных игроков
- **Ожидаемый результат**: Ошибка "Игрок 'имя' указан несколько раз"

#### Тест 2.4: Слишком маленькие размеры карты
- Ширина: 49, Высота: 49
- **Ожидаемый результат**: Ошибка "Ширина/Высота карты должна быть от 50 до 500"

#### Тест 2.5: Слишком большие размеры карты
- Ширина: 501, Высота: 501  
- **Ожидаемый результат**: Ошибка "Ширина/Высота карты должна быть от 50 до 500"

#### Тест 2.6: Попытка добавить 17-го игрока
- Добавьте максимум игроков (16) и попытайтесь добавить еще одного
- **Ожидаемый результат**: JavaScript alert "Максимальное количество игроков: 16"

### 3. Тесты пользовательского интерфейса

#### Тест 3.1: Функциональность добавления игроков
- Нажмите кнопку "Добавить игрока" несколько раз
- **Ожидаемый результат**: Поля добавляются с правильными цветами и placeholder'ами

#### Тест 3.2: Функциональность удаления игроков
- Добавьте несколько игроков, затем удалите некоторых
- **Ожидаемый результат**: Игроки удаляются, placeholder'ы обновляются

#### Тест 3.3: Невозможность удалить первых двух игроков
- Попытайтесь удалить игроков, когда их осталось только 2
- **Ожидаемый результат**: Alert "Нужно минимум 2 игрока для игры"

#### Тест 3.4: Отображение цветов игроков
- Добавьте игроков и проверьте, что цвета генерируются правильно
- **Ожидаемый результат**: У каждого игрока уникальный цвет

#### Тест 3.5: Сохранение данных при ошибке
- Заполните форму, допустите ошибку валидации
- **Ожидаемый результат**: Введенные данные сохраняются в форме

### 4. Тесты безопасности

#### Тест 4.1: HTML-инъекции в названии
- Введите название: `<script>alert('XSS')</script>`
- **Ожидаемый результат**: Скрипт не выполняется, отображается как текст

#### Тест 4.2: HTML-инъекции в именах игроков
- Введите имя игрока: `<img src=x onerror=alert('XSS')>`
- **Ожидаемый результат**: HTML не выполняется

#### Тест 4.3: Очень длинные строки
- Введите название игры длиной более 255 символов
- Введите имена игроков длиной более 50 символов
- **Ожидаемый результат**: Корректная обработка или ограничение ввода

### 5. Тесты интеграции

#### Тест 5.1: Проверка создания в базе данных
- После успешного создания игры проверьте таблицы `game` и `user` в БД
- **Ожидаемый результат**: Записи созданы корректно со всеми параметрами

#### Тест 5.2: Переход к выбору игры
- После создания игры проверьте, что новая игра появляется в списке
- **Ожидаемый результат**: Игра доступна в selectgame

#### Тест 5.3: Генерация карты и стартовых условий
- Создайте игру и проверьте, что вызывается `create_new_game()`
- **Ожидаемый результат**: Карта генерируется, игроки получают стартовые юниты

## Автоматизированное тестирование (рекомендации)

### Тесты JavaScript
```javascript
// Пример теста для добавления игроков
QUnit.test("Добавление игрока", function(assert) {
    var initialCount = $('.create-player').length;
    $('#create-game-add-player').click();
    assert.equal($('.create-player').length, initialCount + 1);
});
```

### Тесты PHP (PHPUnit)
```php
// Пример теста для валидации
public function testCreateGameValidation() {
    $_REQUEST = [
        'name' => '',
        'users' => ['Player1']
    ];
    // Проверить, что $error устанавливается
}
```

## Проверочный лист

- [ ] Форма загружается без ошибок
- [ ] Все поля отображаются корректно
- [ ] JavaScript работает без ошибок в консоли
- [ ] Валидация на клиенте работает
- [ ] Валидация на сервере работает
- [ ] Ошибки отображаются пользователю
- [ ] Успешное создание игры работает
- [ ] Редирект после создания работает
- [ ] Данные корректно сохраняются в БД
- [ ] Безопасность от XSS обеспечена
- [ ] Интерфейс интуитивно понятен

## Отчет о багах

При обнаружении багов заполните:

**Баг #**: [номер]
**Описание**: [что происходит]
**Шаги для воспроизведения**: [1. 2. 3.]
**Ожидаемый результат**: [что должно быть]
**Фактический результат**: [что происходит на самом деле]
**Браузер/ОС**: [информация об окружении]
**Приоритет**: [высокий/средний/низкий]

## Заключение

После прохождения всех тестов функция создания игры считается стабильной и готовой к производственному использованию.